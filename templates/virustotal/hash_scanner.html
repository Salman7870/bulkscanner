{% extends 'base.html' %} {% load static %} {% block body %}
<title>VirusTotal | Hash Scanner</title>
  <div class="page-wrapper">
    <div class="container-xl">
      <!-- Page title -->
      <div class="page-header d-print-none">
        <div class="row align-items-center">
          <div class="col">
            <ol class="breadcrumb breadcrumb-arrows" aria-label="breadcrumbs">
              <li class="breadcrumb-item">
                <a href="{% url 'index' %}">Home</a>
              </li>
              <li class="breadcrumb-item"><a href="#">VirusTotal</a></li>
              
              <li class="breadcrumb-item active" aria-current="page">
                Hash Scanner
              </li>
            </ol>

            <br>
            {% for message in messages %}
            <div class="alert alert-important alert-info alert-dismissible" role="alert">
              <div class="d-flex">
                <div>
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-message-dots" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4"></path>
                    <line x1="12" y1="11" x2="12" y2="11.01"></line>
                    <line x1="8" y1="11" x2="8" y2="11.01"></line>
                    <line x1="16" y1="11" x2="16" y2="11.01"></line>
                 </svg>
                </div>
                <div>
                 {{message}}
                </div>
              </div>
              <a class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="close"></a>
            </div>
            {% endfor %}         
          </div>

          
        </div>
      </div>
    </div>
    <div class="page-body">
      <div class="container-xl">
        <div class="row row-cards">
          <!--Scan in Bulk Start-->
          <div class="col-7">
            <form action="{% url 'hash_scanner' %}" method="POST" class="card" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="card-header">
                <h4 class="card-title">Scan in bulk</h4>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-12">
                    <div class="row">
                      <div class="col-md-6 col-xl-12">                        
                        
                        <div class="mb-3">
                          <div class="form-label required">Select API</div>
                          <select class="form-select" name="vt_api">
                            {% comment %} <option  disabled selected hidden>Select API Key</option> {% endcomment %}

                            {% for data in vt_api_data %}
                              <option value="{{data.api}}">{{data.api|slice:":10"}} - {{data.full_name}}</option>
                              
                            {% endfor %}
                          </select>
                        </div>


                        <div class="mb-3">
                          <div class="form-label required">Select Column</div>
                          <select class="form-select" name="column_name">
                            {% comment %} <option  disabled selected hidden>Select API Key</option> {% endcomment %}

                            {% for data in columns_data %}
                              <option value="{{data.column_name}}">{{data.column_name}}</option>
                              
                            {% endfor %}
                          </select>
                        </div>
                      
                        
                        
                        <div class="mb-3">
                          <div class="form-label required">
                            Upload CSV log file
                          </div>
                          <input type="file" class="form-control" name="logfile" required/>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer text-end">
                <div class="d-flex">
                  <a href="" class="btn btn-link">Cancel</a>
                  <button type="submit" class="btn btn-primary ms-auto">
                    Scan Now
                  </button>
                </div>
              </div>
            </form>
          </div>
          <!--Scan in Bulk End-->

          <!--Scan Single IP Start-->
          <div class="col-5">
            <form action="{% url 'scan_single_hash' %}" method="POST" class="card" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="card-header">
                <h4 class="card-title">Scan Single Hash</h4>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-12">
                    <div class="row">
                      <div class="col-md-6 col-xl-12">                        
                        
                        <div class="mb-3">
                          <div class="form-label required">Select API</div>
                          <select class="form-select" name="vt_api">
                            {% comment %} <option  disabled selected hidden>Select API Key</option> {% endcomment %}

                            {% for data in vt_api_data %}
                              <option value="{{data.api}}">{{data.api|slice:":10"}} - {{data.full_name}}</option>
                              
                            {% endfor %}
                          </select>
                        </div>


                        <div class="mb-3">
                          <div class="form-floating mb-3">
                            <input
                              type="text"
                              class="form-control required"
                              id="floating-input"
                              placeholder="Enter API Key "
                              autocomplete="off"
                              name="hash"
                              required
                            />
                            <label for="floating-input">Enter/Paste Hash</label>
                          </div>
                        </div>
                                           
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer text-end">
                <div class="d-flex">
                  <a href="" class="btn btn-link">Cancel</a>
                  <button type="submit" class="btn btn-primary ms-auto">
                    Scan Now
                  </button>
                </div>
              </div>
            </form>
          </div>
          <!--Scan Single IP ends-->

        </div>

      </div>
      
    </div>
    
  </div>

{% endblock body %}
